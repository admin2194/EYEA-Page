import{ap as q,q as D,P as _,m as E,r as o,ah as s}from"./entry.9f9a9dfb.js";import{l as b}from"./lists.7992369c.js";import{d as F}from"./hasMembership.30c54a92.js";var l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"third_party_auth"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"custom_access_token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"me_access_token"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:79}};l.loc.source={body:`
query  {
  third_party_auth{
    custom_access_token
    me_access_token
  }
}`,name:"GraphQL request",locationOffset:{line:1,column:1}};function r(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var i=e.type;i.kind==="NamedType"&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(n){r(n,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(n){r(n,t)}),e.definitions&&e.definitions.forEach(function(n){r(n,t)})}var N={};(function(){l.definitions.forEach(function(t){if(t.name){var i=new Set;r(t,i),N[t.name.value]=i}})})();const I=q((e,t)=>{const i=D(),n=_("custom_token"),u=_("access_token"),d=E(),m=o(!1),f=o(!1),g=o("third_party"),S=o("");e.query.access_token&&(u.value="Bearer "+d.query.access_token,m.value=!0,console.log(d.query.access_token));const{onResult:y,loading:w,refetch:z}=b(l,{clientId:g,enabled:m,role:S}),{onResult:M,loading:T,refetch:x}=b(F,{enabled:f});y(R=>{var p,h;if(n.value="Bearer "+((h=(p=R.data)==null?void 0:p.third_party_auth)==null?void 0:h.custom_access_token),n.value){const a={};if(a.custom_token=n.value,i.set(a),i.users.metadata.roles.includes("super:admin"))return u.value="",n.value="",i.unset(),notify({title:"Invalid password or email",description:"insert correct user password or email",cardClass:"bg-red-100"}),s({path:"/login"});f.value=!0}M(({data:a})=>{var v,k;let c={individualMem:(v=a.individual_membership)==null?void 0:v.length,organizationMem:(k=a.organization_membership)==null?void 0:k.length};return i.setMembershipStat(c),c.individualMem>0?s({path:"/app#individual"}):c.organizationMem>0?s({path:"/app#organization"}):s({path:"/"})})})});export{I as default};

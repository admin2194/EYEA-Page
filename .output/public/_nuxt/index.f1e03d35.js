import{B as J,q as K,P as I,v as W,s as X,r as p,c as $,a as o,y as Y,d as k,w as g,u as m,p as L,h as Z,o as D,b as ee,f as te}from"./entry.9f9a9dfb.js";import{_ as ne}from"./Textfield.377202c6.js";import{_ as ie}from"./nuxt-link.0f5721f5.js";import{_ as ae}from"./EYEA_Logo_Color_Final.b1d55aa4.js";import{_ as oe}from"./EYEA_cropped.50ccadf2.js";import{m as T}from"./mutator.d9223ad6.js";import{d as se}from"./hasMembership.30c54a92.js";import{l as re}from"./lists.7992369c.js";var S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"token"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id_token"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"custom_token"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id_token"},value:{kind:"Variable",name:{kind:"Name",value:"id_token"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"custom_token"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:117}};S.loc.source={body:`mutation token($id_token: String!) {
  custom_token(id_token: $id_token) {
    data {
      custom_token
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function b(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var n=e.type;n.kind==="NamedType"&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(i){b(i,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(i){b(i,t)}),e.definitions&&e.definitions.forEach(function(i){b(i,t)})}var V={};(function(){S.definitions.forEach(function(t){if(t.name){var n=new Set;b(t,n),V[t.name.value]=n}})})();function O(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function le(e,t){var n={kind:e.kind,definitions:[O(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=V[t]||new Set,l=new Set,r=new Set;for(i.forEach(function(s){r.add(s)});r.size>0;){var f=r;r=new Set,f.forEach(function(s){if(!l.has(s)){l.add(s);var d=V[s]||new Set;d.forEach(function(h){r.add(h)})}})}return l.forEach(function(s){var d=O(e,s);d&&n.definitions.push(d)}),n}le(S,"token");var N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"login"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LoginInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"auth"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"login"},arguments:[{kind:"Argument",name:{kind:"Name",value:"params"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"access_token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id_token"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:119}};N.loc.source={body:`mutation login($data: LoginInput!) {
  auth {
    login(params: $data) {
      access_token
      id_token
    }
  }
}
`,name:"GraphQL request",locationOffset:{line:1,column:1}};function w(e,t){if(e.kind==="FragmentSpread")t.add(e.name.value);else if(e.kind==="VariableDefinition"){var n=e.type;n.kind==="NamedType"&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(i){w(i,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(i){w(i,t)}),e.definitions&&e.definitions.forEach(function(i){w(i,t)})}var R={};(function(){N.definitions.forEach(function(t){if(t.name){var n=new Set;w(t,n),R[t.name.value]=n}})})();function B(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function de(e,t){var n={kind:e.kind,definitions:[B(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=R[t]||new Set,l=new Set,r=new Set;for(i.forEach(function(s){r.add(s)});r.size>0;){var f=r;r=new Set,f.forEach(function(s){if(!l.has(s)){l.add(s);var d=R[s]||new Set;d.forEach(function(h){r.add(h)})}})}return l.forEach(function(s){var d=B(e,s);d&&n.definitions.push(d)}),n}de(N,"login");const ce={class:"grid h-screen grid-cols-5 px-3 md:px-0"},me={class:"flex items-center col-span-5 lg:col-span-3 px- dark:bg-dark-secondary"},ue={class:"absolute top-3 left-6 text-primary-text-light dark:text-dark-text-secondary font-poppins"},fe={class:"absolute top-3 left-6 text-primary-text-light dark:text-dark-text-secondary font-poppins"},pe={type:"submit",class:"px-4 w-full h-[40px] rounded-md bg-primary text-white mt-4"},ke={key:0},ve={class:"flex justify-between w-full pt-2 text-primary-text-light dark:text-white"},ge={class:"mt-3"},he={class:"flex items-center justify-center mt-3 space-x-4 gap-x-3"},xe=["href"],Ie={__name:"index",setup(e){const{notify:t}=J(),n=K(),i=I("custom_token"),l=I("access_token"),{handleSubmit:r}=W({}),f=X(),s=p("member_anonymous"),d=p("member_user"),q=p(`https://auth.eyea.et/oauth_login/google?redirectURL=https://staging.eyea.et&state=${new Date().getTime()}`),x=p(""),_=p(""),{mutate:M,loading:U,onDone:z,onError:C}=T(N,{clientId:s});z(c=>{l.value="Bearer "+c.data.auth.login.access_token,Q({id_token:c.data.auth.login.id_token})}),C(c=>{t({title:"Invalid password or email",description:"insert correct user password or email",cardClass:"bg-red-100"})});const{mutate:Q,loading:j,onDone:P,onError:_e}=T(S,{clientId:s}),F=r(async c=>{M({data:{email:x.value,password:_.value}})});P(c=>{i.value="Bearer "+c.data.custom_token.data.custom_token;const a={};a.access_token=l.value,a.custom_token=i.value,n.set(a),E.value=!0});const E=p(!1),{onResult:A,onError:ye,loading:G,refetch:be}=re(se,{enabled:E,clientId:d});return A(({data:c})=>{var a,u;if(c){let y={individualMem:(a=c.user_individual_membership)==null?void 0:a.length,organizationMem:(u=c.user_organization_membership)==null?void 0:u.length};n.users.metadata.roles.includes("super:admin")?(l.value="",i.value="",n.unset(),t({title:"Invalid password or email",description:"insert correct user password or email",cardClass:"bg-red-100"}),console.log("super admin"),E.value=!1,f.push("/login")):(n.setMembershipStat(y),f.push({name:"app"}))}}),(c,a)=>{const u=te,y=ne,H=ie;return D(),$("div",ce,[a[9]||(a[9]=o("div",{class:"items-center hidden col-span-2 bg-third-light2 dark:bg-dark-primary-light lg:flex dark:text-white"},[o("div",{class:"space-y-10 border-l-4 px-20 border-[#40FF81]"},[o("div",null,[o("img",{src:ae,alt:"",srcset:""})])])],-1)),o("div",me,[o("form",{onSubmit:a[2]||(a[2]=Y((...v)=>m(F)&&m(F)(...v),["prevent"])),class:"2xl:w-[40%] md:w-[50%] lg:w-[60%] w-full mx-auto my-auto"},[a[8]||(a[8]=o("div",{class:"flex flex-col items-center justify-center w-full py-5 text-3xl gap-y-10 dark:text-white"},[o("div",{class:"max-w-[10rem] md:hidden"},[o("img",{src:oe,alt:"eyea logo"})]),o("p",{class:"mx-auto"},"Login")],-1)),k(y,{modelValue:m(x),"onUpdate:modelValue":a[0]||(a[0]=v=>L(x)?x.value=v:null),name:"email",rules:"required",type:"email",class:"focus:border-primary px-16 py-[12px] mb-6 dark:bg-dark-secondary",placeholder:"email","placeholder-style":"text-primary-text-light dark:text-dark-text-secondary  "},{leading:g(()=>[o("div",ue,[k(u,{name:"ic:outline-email",width:"25",height:"25"})])]),label:g(()=>a[3]||(a[3]=[o("div",{class:"mb-3 top-3 left-6 text-secondary-text dark:text-dark-text-secondary font-poppins"}," Email ",-1)])),_:1},8,["modelValue"]),k(y,{modelValue:m(_),"onUpdate:modelValue":a[1]||(a[1]=v=>L(_)?_.value=v:null),type:"password",rules:"required",trailingIcon:"mdi:eye-outline",name:"password",class:"focus:border-primary px-16 py-[12px] mb-6 dark:bg-dark-secondary",placeholder:"password","placeholder-style":"text-primary-text-light dark:text-dark-text-secondary  "},{leading:g(()=>[o("div",fe,[k(u,{name:"material-symbols:lock-outline",width:"25",height:"25"})])]),label:g(()=>a[4]||(a[4]=[o("div",{class:"mb-3 top-3 left-6 text-secondary-text dark:text-dark-text-secondary font-poppins"}," password ",-1)])),_:1},8,["modelValue"]),o("button",pe,[!m(U)||m(j)||m(G)?(D(),$("p",ke,"Login")):(D(),Z(u,{key:2,name:"line-md:loading-twotone-loop",class:"text-2xl text-white"}))]),o("div",ve,[k(H,{class:"hover:text-primary",to:"/signup"},{default:g(()=>a[5]||(a[5]=[ee("I don't have an account")])),_:1}),a[6]||(a[6]=o("p",null,"forgot password",-1))]),o("div",ge,[a[7]||(a[7]=o("p",{class:"grid items-center grid-cols-3 text-center"},[o("span",{class:"w-full h-px bg-gray-200"}),o("span",{class:"text-primary-text-light dark:text-white"},"or login with"),o("span",{class:"w-full h-px bg-gray-200"})],-1)),o("div",he,[o("a",{href:m(q),class:"flex items-center p-2 border rounded hover:bg-primary-light hover:text-white"},[k(u,{name:"logos:google-icon",class:"text-2xl"})],8,xe)])])],32)])])}}};export{Ie as default};
